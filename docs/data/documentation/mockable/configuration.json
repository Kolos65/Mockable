{"kind":"article","variants":[{"traits":[{"interfaceLanguage":"swift"}],"paths":["\/documentation\/mockable\/configuration"]}],"schemaVersion":{"minor":3,"major":0,"patch":0},"seeAlsoSections":[{"title":"Guides","generated":true,"anchor":"Guides","identifiers":["doc:\/\/Mockable\/documentation\/Mockable\/Installation","doc:\/\/Mockable\/documentation\/Mockable\/Usage"]}],"abstract":[{"type":"text","text":"Learn how to configure build settings so generated mock implementations are excluded from release builds."}],"primaryContentSections":[{"kind":"content","content":[{"type":"heading","anchor":"Overview","level":2,"text":"Overview"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Since "},{"type":"codeVoice","code":"@Mockable"},{"type":"text","text":" is a peer macro the generated code will always be at the same scope as the protocol it is attached to. From "},{"type":"strong","inlineContent":[{"text":"Mockable","type":"text"}]},{"type":"text","text":"‘s perspective this is unfortunate as we don’t want to include our generated mock implementations in the release bundle."}]},{"type":"paragraph","inlineContent":[{"text":"To solve this, the macro expansion is enclosed in a pre-defined compile-time flag called ","type":"text"},{"inlineContent":[{"type":"codeVoice","code":"MOCKING"}],"type":"strong"},{"text":" that can be leveraged to exclude generated mock implementations from release builds:","type":"text"}]},{"type":"codeListing","syntax":"swift","code":["#if MOCKING","public final class MockService: Service, Mockable {","    \/\/ generated code...","}","#endif"]},{"name":"Note","type":"aside","content":[{"inlineContent":[{"text":"Since the ","type":"text"},{"inlineContent":[{"type":"codeVoice","code":"MOCKING"}],"type":"strong"},{"text":" flag is not defined in your project by default, you won’t be able to use mock implementations unless you configure it.","type":"text"}],"type":"paragraph"}],"style":"note"},{"type":"paragraph","inlineContent":[{"text":"There are many ways to define the flag depending on how your project is set up or what tool you use for build setting generation. Below you can find how to define the ","type":"text"},{"code":"MOCKING","type":"codeVoice"},{"text":" flag in three common scenarios.","type":"text"}]},{"type":"heading","anchor":"Define-the-flag-using-Xcode","level":2,"text":"Define the flag using Xcode"},{"type":"paragraph","inlineContent":[{"text":"If your porject relies on Xcode build settings, define the flag in your target’s build settings for debug build configuration(s):","type":"text"}]},{"type":"orderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"Open your ","type":"text"},{"inlineContent":[{"text":"Xcode project","type":"text"}],"type":"strong"},{"text":".","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Go to your target’s ","type":"text"},{"type":"strong","inlineContent":[{"text":"Build Settings","type":"text"}]},{"text":".","type":"text"}]}]},{"content":[{"inlineContent":[{"text":"Find ","type":"text"},{"inlineContent":[{"text":"Swift Compiler - Custom Flags","type":"text"}],"type":"strong"},{"text":".","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Add the ","type":"text"},{"inlineContent":[{"text":"MOCKING","type":"text"}],"type":"strong"},{"text":" flag under the debug build configuration(s).","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Repeat these steps for all of your targets where you want to use the "},{"type":"codeVoice","code":"@Mockable"},{"type":"text","text":" macro."}]}]}]},{"type":"heading","anchor":"Using-a-Packageswift-manifest","level":2,"text":"Using a Package.swift manifest"},{"type":"paragraph","inlineContent":[{"text":"If you are using SPM modules or working with a package, define the ","type":"text"},{"inlineContent":[{"type":"codeVoice","code":"MOCKING"}],"type":"strong"},{"text":" compile-time condition in your package manifest. Using a ","type":"text"},{"code":".when(configuration:)","type":"codeVoice"},{"text":" build setting condition you can define the flag only if the build configuration is set to ","type":"text"},{"code":"debug","type":"codeVoice"},{"text":".","type":"text"}]},{"type":"codeListing","syntax":"swift","code":[".target(","    ...","    swiftSettings: [","        .define(\"MOCKING\", .when(configuration: .debug))","    ]",")"]},{"type":"heading","text":"Using XcodeGen","level":2,"anchor":"Using-XcodeGen"},{"type":"paragraph","inlineContent":[{"text":"If you use XcodeGen to generate you project, you can define the ","type":"text"},{"type":"codeVoice","code":"MOCKING"},{"text":" flag in your yaml file under the ","type":"text"},{"type":"codeVoice","code":"configs"},{"text":" definition.","type":"text"}]},{"type":"codeListing","syntax":"yml","code":["settings:","  ...","  configs:","    debug:","      SWIFT_ACTIVE_COMPILATION_CONDITIONS: MOCKING"]},{"type":"heading","text":"Using Tuist:","level":2,"anchor":"Using-Tuist"},{"type":"paragraph","inlineContent":[{"text":"If you use Tuist, you can define the ","type":"text"},{"code":"MOCKING","type":"codeVoice"},{"text":" flag in your target’s settings under ","type":"text"},{"code":"configurations","type":"codeVoice"},{"text":".","type":"text"}]},{"type":"codeListing","syntax":"swift","code":[".target(","    ...","    settings: .settings(","        configurations: [","            .debug(","                name: .debug, ","                settings: [","                    \"SWIFT_ACTIVE_COMPILATION_CONDITIONS\": \"$(inherited) MOCKING\"","                ]","            )","        ]","    )",")"]},{"type":"heading","text":"Summary","level":2,"anchor":"Summary"},{"type":"paragraph","inlineContent":[{"type":"text","text":"By defining the "},{"type":"codeVoice","code":"MOCKING"},{"type":"text","text":" condition in the debug build configuration you ensured that generated mock implementations are excluded from release builds and kept available for your unit tests that use the debug configuration to build tested targets."}]}]}],"hierarchy":{"paths":[["doc:\/\/Mockable\/documentation\/Mockable"]]},"metadata":{"roleHeading":"Article","modules":[{"name":"Mockable"}],"role":"article","title":"Configuration"},"sections":[],"identifier":{"url":"doc:\/\/Mockable\/documentation\/Mockable\/Configuration","interfaceLanguage":"swift"},"references":{"doc://Mockable/documentation/Mockable":{"kind":"symbol","identifier":"doc:\/\/Mockable\/documentation\/Mockable","abstract":[{"type":"text","text":"A macro driven testing framework that provides automatic mock implementations for your protocols. It offers an intuitive declarative syntax that simplifies the process of mocking services in unit tests."}],"title":"Mockable","role":"collection","url":"\/documentation\/mockable","type":"topic"},"doc://Mockable/documentation/Mockable/Usage":{"type":"topic","title":"Usage","url":"\/documentation\/mockable\/usage","role":"article","abstract":[{"type":"text","text":"Larn how to use "},{"type":"strong","inlineContent":[{"text":"Mockable","type":"text"}]},{"type":"text","text":" to write readable and concise unit tests."}],"kind":"article","identifier":"doc:\/\/Mockable\/documentation\/Mockable\/Usage"},"doc://Mockable/documentation/Mockable/Installation":{"kind":"article","identifier":"doc:\/\/Mockable\/documentation\/Mockable\/Installation","type":"topic","url":"\/documentation\/mockable\/installation","role":"article","abstract":[{"type":"text","text":"Learn how to install "},{"type":"strong","inlineContent":[{"type":"text","text":"Mockable"}]},{"type":"text","text":" and integrate into your targets."}],"title":"Installation"}}}